## 词法分析
词法分析程序占据相当一部分编译时间，提高词法分析程序效率有较高收益。

### 词法程序与语法分析程序的关系

&emsp;词法分析单独一遍，即为独立的。其对程序的处理流程为

<center>
字符串表示的源程序->词法分析程序->记号流表示的源程序
</center>

&emsp;词法分析程序作为语法分析的子程序。避免了中间文件，不需要存取符号，提高了效率。每次需要**新符号**时调用，已经识别的存在符号表中。

<center>
字符串表示的源程序--字符-->词法分析程序<--取记号   记号-->语法分析程序-->
                             |--- >       符号表            ><--|                                   
</center>

&emsp;词法分析程序和语法分析程序为协同程序，安排再同一遍中，以生产者和消费者的关系同步运行。协同程序：两个或两个以上的程序交叉执行。区别于子程序，两个程序都可以在自己的某一段停止转向另一个程序，而子程序必须执行完才能回到主程序中。

**上述三种方式的一个特点是将词法分析程序相对于语法分析程序独立，这样可以简化设计，改进编译效率（专门提高词法分析程序效率，以提高总体效率），提高程序可移植性（将特殊字符处理放在词法分析中）**

### 词法分析程序的实现

&emsp;一是用词法分析程序生成器（通过正规表达式的规范说明，自动生成相应程序）；二是用程序设计语言写；三是用汇编语言实现。

关于生成器：如LEX，输入是LEX源程序，即词法分析程序的规格说明，据此LEX工具可以生成一个C语言编写的词法分析程序。

#### 输入缓冲区

&esmp;因为一些字符的意义可能需要前面的字符确定，因此设置一个缓冲区保存输入字符。缓冲区有左右两个半区，均可以存储N个字符。当一个半区的字符即将使用完时，读入相应的字符到下一个半区。

#### 输出
&emsp;词法分析程序输出的是记号流表示的源程序。

输出的形式：分离出一个单词后，输出一个二元的符号<记号，属性>。

记号（token）：记号指的是某一类单词符号的类别编码。如标识符的记号为id，常数的记号是num。程序设计语言的一般都包含记号：关键字，标识符，常数，字符串和运算符，以及逗号等标点符号。记号属性：影响着记号的翻译，在词法分析阶段，只能确定一种属性，标识符对应符号表入口的指针，常数对应的是它的值。其余的如果一个记号对应多个可能值，也是采用表的形式，属性对应的是入口的指针。如果一个记号对应一个值，属性可以为空。

模式（pattern）：某一类单词符号的构词规则。如标识符的模式是“字母开头的字母数字串”

单词（lexeme）：某一类单词符号的一个特例。

在语法分析阶段不需要知道记号具体的数值。在翻译阶段则需要知道记号的具体数值。

#### 记号描述和识别

&emsp;正规表达式描述，清晰简洁；正规文法描述易于识别；利用正规定义式将正规表达式转换为等价的正规文法。

词法和语法：源语言的文法被分成若干个子文法G0,G1,G2等，其中G1,G2等用以描述语言的卞师傅，常数，运算符和标点等记号的文法，称为词法；G0是借助于记号来描述语言的结构的文法，称之为语法。

初级字符表，一般字母表：文法G1，G2等定义在初级字母表上，该字母表上的每个符号都是字符，而G0定义在一般的字母表上，该字母表上的每个元素是语言的记号。

&emsp;状态转换图用以辅助构建词法分析程序：在编写词法分析程序时，先给出语言中单词符号的词法规则，然后构造整个词法分析程序的状态转换图（即让所有单词的状态转换图共用一个初态），最后根据状态转换图构造词法分析程序。


